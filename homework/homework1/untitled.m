%Matlab code clc clear all; %% sampling points in the domain of [-1,1] x=-1:0.02:1; %% generating training data, and the desired outputs y=x.^3 + 0.3 * x.^2 -0.4 * x; %% specify the structure and learning algorithm for MLP net = feedforwardnet(3,'trainlm'); net.layers{1}.transferFcn = 'tansig'; net.layers{2}.transferFcn = 'purelin'; net = configure(net,x,y); net.trainparam.lr=0.01; net.trainparam.epochs=10000; net.trainparam.goal=1e-8; net.divideParam.trainRatio=1.0; net.divideParam.valRatio=0.0; net.divideParam.testRatio=0.0; %% Train the MLP [net,tr]=train(net,x,y); %% Test the MLP, net_output is the output of the MLP, ytest is the desired output. xtest=-1:0.01:1; ytest=xtest.^3 + 0.3 * xtest.^2 -0.4 * xtest; net_output=sim(net,xtest); %% Plot out the test results plot(xtest,ytest,'b+'); hold on; plot(xtest,net_output,'r-'); hold off